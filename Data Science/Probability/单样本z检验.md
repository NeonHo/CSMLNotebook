# 单样本z检验（One-Sample Z-Test）

单样本z检验是一种统计假设检验方法，用于确定**样本均值**与**已知总体均值**之间是否存在显著差异。与[[t检验]]不同，z检验要求**总体标准差已知**或**样本量足够大**（通常n>30），此时样本标准差可较好地估计总体标准差。

## 基本原理
1. **假设设定**：
   - **零假设**（H₀）：样本均值等于总体均值，即 μ = μ₀  
   - **备择假设**（H₁）：样本均值不等于/大于/小于总体均值（双侧/单侧检验）

2. **检验统计量计算**：
   $$
   z = \frac{\bar{X} - \mu_0}{\sigma / \sqrt{n}}
   $$
   其中：
   - $\bar{X}$：样本均值  
   - $\mu_0$：已知总体均值  
   - $\sigma$：总体标准差  
   - $n$：样本量  

3. **临界值与p值**：
   - 根据显著性水平α（如0.05）和检验类型（双侧/单侧），查表确定临界z值。
   - 若计算得到的z值超出临界值范围，则拒绝H₀。

## 适用条件
1. **总体标准差σ已知**（若未知但n>30，可用样本标准差s近似）。
2. **样本来自正态分布总体**（若n>30，根据中心极限定理可近似正态分布）。
3. **样本独立随机抽取**。

## 步骤示例
**问题**：某工厂生产的零件平均重量为100克（σ=5）。现抽取25个零件，测得平均重量为102克。问样本是否显著偏离总体？

**解答**：
1. **假设**：
   - H₀: μ = 100  
   - H₁: μ ≠ 100（双侧检验）

2. **计算z值**：
   $$
   z = \frac{102 - 100}{5 / \sqrt{25}} = \frac{2}{1} = 2
   $$

3. **确定临界值**：  
   双侧检验，α=0.05 → 临界z值为±1.96。

4. **决策**：  
   计算的z=2 > 1.96 → 拒绝H₀，样本均值显著偏离总体均值。

## 与t检验的对比
| **特征**         | **单样本z检验**               | **单样本t检验**               |
|------------------|------------------------------|------------------------------|
| **总体标准差**   | 必须已知（或n>30）            | 未知，用样本标准差估计       |
| **分布**         | 正态分布（z分布）             | t分布（自由度=n-1）           |
| **样本量**       | 通常要求n>30                 | 适用于小样本（n<30）         |
| **应用场景**     | 大样本或σ已知的情况           | σ未知的小样本或大样本         |

## Python实现示例
```python
from scipy import stats

# 已知总体参数
mu_0 = 100  # 总体均值
sigma = 5   # 总体标准差

# 样本数据
sample_mean = 102
n = 25

# 计算z值
z_score = (sample_mean - mu_0) / (sigma / (n ** 0.5))

# 计算双侧p值
p_value = 2 * (1 - stats.norm.cdf(abs(z_score)))

print(f"z值: {z_score:.2f}")  # 输出: 2.00
print(f"p值: {p_value:.4f}")  # 输出: 0.0455 (α=0.05时拒绝H₀)
```

## 注意事项
1. **实际应用限制**：  
   现实中总体标准差通常未知，因此z检验不如t检验常用。

2. **单侧检验**：  
   若备择假设为H₁: μ > μ₀（或μ < μ₀），则p值计算需调整为单侧概率。

3. **样本量与正态性**：  
   当n<30且σ未知时，应使用t检验而非z检验。