AR（Autoregressive Model，自回归模型）是时序预测中最基础的模型之一，核心思想是**利用序列自身的历史数据来预测未来值**，即通过变量过去的观测值（滞后项，[[时间序列预测基本概念#**10. 滞后项（Lag）**]]）构建回归方程。以下从定义、原理、关键要素到应用场景进行详细解析：


### **一、AR模型的定义**
AR模型是一种线性模型，假设时序数据$y_t$（$t$表示时间点）可以由其过去$p$个时刻的观测值（滞后项）的线性组合加上随机误差项表示。其数学表达式为：

$$
y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \dots + \phi_p y_{t-p} + \epsilon_t
$$

其中：
- $y_t$：$t$时刻的观测值（待预测值）；
- $p$：模型阶数（即使用的滞后项数量），对应模型记为$AR(p)$；
- $c$：常数项（截距）；
- $\phi_1, \phi_2, \dots, \phi_p$：滞后项的系数（模型参数，需通过数据估计）；
- $\epsilon_t$：随机误差项（白噪声）[[时间序列预测基本概念#**11. 白噪声（White Noise）**]]，满足均值为0、方差恒定且各期独立（即$\epsilon_t \sim WN(0, \sigma^2)$）。


### **二、AR模型的核心原理**
AR模型的本质是**利用序列的[[ACF自相关性]]**：时序数据中当前值与过去值存在依赖关系（如今天的气温与昨天、前天的气温相关），通过建模这种依赖关系实现预测。

- 例如，$AR(1)$模型（一阶自回归）仅用前1期数据预测当前值：
  $$
  y_t = c + \phi_1 y_{t-1} + \epsilon_t
  $$
- $AR(2)$模型（二阶自回归）用前2期数据预测：
  $$
  y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + \epsilon_t
  $$


### **三、AR模型的前提条件**
AR模型的有效性依赖于时序数据满足**平稳性**和**弱相关性**：
1. **平稳性**  [[时间序列预测基本概念#**6. 平稳性（Stationarity）**]]
   AR模型要求序列是**弱平稳的**（均值、方差恒定，自协方差仅与滞后阶数有关）。若序列非平稳（如存在趋势或单位根），需先通过差分（如转化为ARIMA模型）使其平稳，否则模型参数估计会失真，预测结果不可靠。

2. **弱相关性**  
   序列的自相关性需随滞后阶数增加而衰减（即“短期记忆性”），否则模型无法通过有限滞后项捕捉规律。


### **四、AR模型阶数$p$的确定**
阶数$p$是AR模型的关键参数，决定了使用多少个历史数据点进行预测。常用确定方法有：

1. **偏自相关函数（[[PACF]]）截尾法**  
   - 偏自相关函数（PACF）衡量序列在控制中间滞后项影响后，当前值与滞后$k$期值的净相关性。  
   - 对于$AR(p)$模型，其PACF在滞后阶数$k > p$时会**突然趋近于0**（即“截尾”）。因此，PACF图中截尾的位置即为$p$的合理取值。

   例如：
   - $AR(1)$的PACF在$k=1$时显著不为0，$k \geq 2$时接近0；
   - $AR(2)$的PACF在$k=1,2$时显著不为0，$k \geq 3$时接近0。

2. **信息准则法**  [[AIC & BIC]]
   通过最小化信息准则（如AIC、BIC）选择最优$p$：
   - AIC（Akaike Information Criterion）：$AIC = 2p - 2\ln(L)$，$L$为似然函数值；
   - BIC（Bayesian Information Criterion）：$BIC = p\ln(n) - 2\ln(L)$，$n$为样本量。  
   准则值越小，模型对数据的拟合越好（同时避免过拟合）。


### **五、AR模型的参数估计**
确定阶数$p$后，需估计系数$\phi_1, \dots, \phi_p$和常数项$c$，常用方法为**最小二乘法（OLS）**：
- 目标：最小化预测值与实际值的平方误差和$\sum_{t=p+1}^n (y_t - \hat{y}_t)^2$，其中$\hat{y}_t$是模型的预测值。
- 结果：通过OLS可得到系数的最优估计值$\hat{\phi}_1, \dots, \hat{\phi}_p$，代入模型即可用于预测。


### **六、AR模型的预测过程**
以$AR(p)$模型为例，预测步骤如下：
1. 对历史数据进行平稳性检验（如[[ADF检验]]），非平稳则先处理；
2. 用PACF或信息准则确定阶数$p$；
3. 估计模型参数$\hat{\phi}_1, \dots, \hat{\phi}_p$和$c$；
4. 预测未来值：
   - 短期预测（如预测$y_{n+1}$）：使用最近$p$期的实际值$y_n, y_{n-1}, \dots, y_{n-p+1}$代入模型；
   - 长期预测（如预测$y_{n+k}, k>1$）：需递归使用已预测的值（如$y_{n+1}$的预测值用于计算$y_{n+2}$）。


### **七、AR模型的优缺点**
- **优点**：
  - 原理简单，可解释性强（系数直接反映历史数据的影响权重）；
  - 计算高效，适用于短期预测和数据量较小的场景。

- **缺点**：
  - 仅适用于平稳序列，无法直接处理趋势或季节性数据；
  - 是线性模型，难以捕捉非线性关系（如需处理非线性，可结合神经网络等方法）；
  - 长期预测误差会累积，精度随预测步长增加而下降。


### **八、AR模型的应用场景**
AR模型适用于**短期预测**和**具有明显自相关性的平稳序列**，例如：
- 股票价格短期波动（假设剔除趋势后平稳）；
- 电力负荷短期预测（小时级或日级）；
- 环境监测数据（如PM2.5浓度的短期变化）。


### **总结**
AR模型是时序分析的基础工具，其核心是通过历史数据的线性组合建模。实际应用中，常与差分（I）、移动平均（MA）结合形成[[ARIMA]]模型，以处理非平稳序列或更复杂的时序模式。理解AR模型的原理和局限性，是掌握更复杂时序模型的重要基础。