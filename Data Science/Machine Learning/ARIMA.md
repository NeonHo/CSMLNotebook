ARIMA（Autoregressive Integrated Moving Average，自回归积分移动平均模型）是一种经典的[[时间序列预测]]方法，广泛应用于经济、金融、销售等领域的短期预测。它结合了自回归（AR）、差分（I）和移动平均（[[MA]]）三种机制，能有效处理具有趋势性或非平稳性的时间序列数据。


### 一、ARIMA的核心构成
ARIMA模型的全称是“ARIMA(p, d, q)”，其中三个参数的含义如下：
- **p**：自回归（AR）项的阶数，即模型依赖的历史观测值的数量；
- **d**：差分（I）的阶数，用于将非平稳序列转换为平稳序列的差分次数；
- **q**：移动平均（MA）项的阶数，即模型依赖的历史误差项的数量。

要理解ARIMA，需先掌握其基础组件：AR模型、MA模型、差分操作，以及它们的组合形式ARMA模型。


### 二、基础组件解析
#### 1. 自回归模型（AR(p)）[[AR自回归]]
自回归模型（Autoregressive Model）假设当前观测值依赖于过去的p个观测值，其数学表达式为：  
$y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + ... + \phi_p y_{t-p} + \epsilon_t$  

其中：
- $y_t$ 是t时刻的观测值；
- $c$ 是常数项；
- $\phi_1, \phi_2, ..., \phi_p$ 是自回归系数（需通过数据估计）；
- $y_{t-1}, ..., y_{t-p}$ 是过去p个时刻的观测值；
- $\epsilon_t$ 是t时刻的白噪声（均值为0、方差恒定、各期不相关的随机误差）。

**核心逻辑**：用历史数据“预测”当前值，例如AR(1)表示当前值仅依赖于前1个时刻的值：$y_t = c + \phi_1 y_{t-1} + \epsilon_t$。

**平稳性条件**：AR(p)模型要求序列平稳（均值和方差不随时间变化），且自回归系数需满足“特征方程根的绝对值大于1”（例如AR(1)需满足$|\phi_1| < 1$），否则序列会发散。


#### 2. 移动平均模型（MA(q)）
移动平均模型（Moving Average Model）假设当前观测值依赖于过去的q个误差项（白噪声），其数学表达式为：  
$y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1} + ... + \theta_q \epsilon_{t-q}$  

其中：
- $\mu$ 是序列的均值；
- $\theta_1, ..., \theta_q$ 是移动平均系数（需通过数据估计）；
- $\epsilon_t, \epsilon_{t-1}, ..., \epsilon_{t-q}$ 是t时刻及过去q个时刻的白噪声。

**核心逻辑**：用历史预测误差“修正”当前值，例如MA(1)表示当前值依赖于当前误差和前1个误差：$y_t = \mu + \epsilon_t + \theta_1 \epsilon_{t-1}$。

**可逆性条件**：MA(q)模型需满足“移动平均系数的特征方程根的绝对值大于1”（例如MA(1)需满足$|\theta_1| < 1$），否则模型参数无法唯一确定。


#### 3. ARMA模型（AR与MA的结合）
ARMA(p, q)是AR(p)和MA(q)的组合，适用于**平稳序列**，其表达式为：  
$y_t = c + \phi_1 y_{t-1} + ... + \phi_p y_{t-p} + \epsilon_t + \theta_1 \epsilon_{t-1} + ... + \theta_q \epsilon_{t-q}$  

其中：
- 左侧是AR项（依赖历史观测值）；
- 右侧是MA项（依赖历史误差）。


#### 4. 差分（I）操作 
[[时间序列预测基本概念#**7. 差分（Differencing）**]]
ARMA模型仅适用于**平稳序列**，但实际中的时间序列常因趋势（如增长）或季节性而非平稳。差分（Integration）操作的作用是将非平稳序列转换为平稳序列，具体为：  
- 1阶差分：$y'_t = y_t - y_{t-1}$（消除线性趋势）；
- 2阶差分：$y''_t = y'_t - y'_{t-1} = (y_t - y_{t-1}) - (y_{t-1} - y_{t-2}) = y_t - 2y_{t-1} + y_{t-2}$（消除二次趋势）；
- d阶差分：对序列重复d次1阶差分，直至序列平稳。


#### 5. ARIMA(p, d, q)模型
ARIMA(p, d, q)是ARMA(p, q)模型在非平稳序列上的扩展：先对非平稳序列进行d阶差分得到平稳序列，再对平稳序列应用ARMA(p, q)模型。其预测逻辑可总结为：  
$(\text{差分后平稳序列}) \sim \text{ARMA}(p, q) \implies (\text{原始序列}) \sim \text{ARIMA}(p, d, q)$  


### 三、ARIMA建模步骤
ARIMA的建模过程需严格遵循“平稳化→定阶→拟合→诊断→预测”的流程，具体如下：

#### 1. 序列平稳性检验
ARIMA要求输入序列经过d阶差分后平稳，因此需先检验原始序列的平稳性，常用方法：  
- **可视化**：绘制时序图，观察是否存在明显趋势或波动（非平稳序列通常有趋势或方差随时间变化）；
- **[[ADF检验]]**（Augmented Dickey-Fuller Test）：原假设为“序列非平稳”，若p值＜0.05（显著性水平），则拒绝原假设，认为序列平稳。

若原始序列非平稳，需进行d阶差分（d通常取1或2，极少超过2），直至差分后序列通过平稳性检验。


#### 2. 确定p和q的阶数
通过自相关函数（ACF）和偏自相关函数（PACF）确定p和q：  
- **[[ACF自相关性]]**：描述序列与自身滞后项的相关性；
- **PACF**：描述序列与自身滞后项在排除中间项影响后的相关性。

定阶规则（经验性）：
- 若AR(p)的PACF在滞后p阶后“截尾”（突然趋近于0），则p为该阶数；
- 若MA(q)的ACF在滞后q阶后“截尾”，则q为该阶数；
- 若ACF和PACF均“拖尾”（缓慢趋近于0），需结合AIC/BIC准则（选择AIC/BIC最小的模型）辅助定阶。[[AIC & BIC]]


#### 3. 模型拟合与参数估计
根据确定的(p, d, q)，用极大似然估计或最小二乘法估计模型参数（$\phi_1,..., \phi_p$、$\theta_1,..., \theta_q$等）。


#### 4. 模型诊断
检验模型是否合理，核心是**残差需为白噪声**（即残差无自相关性，均值为0，方差恒定）：  
- 残差ACF/PACF：所有滞后项的相关系数均需在95%置信区间内（即|r|＜1.96/√n，n为样本量）；
- Ljung-Box检验：原假设为“残差无自相关”，若p值＞0.05，则接受原假设。

若残差非白噪声，需重新调整(p, d, q)参数。


#### 5. 预测
模型通过诊断后，可用于预测未来值。ARIMA的预测是“滚动式”的：预测t+1时刻的值需用到t时刻的观测值（或预测值），预测t+2时刻的值需用到t+1时刻的预测值，以此类推。


### 四、示例：ARIMA(1,1,1)模型
假设某序列经1阶差分后平稳（d=1），且通过ACF/PACF确定p=1、q=1，则模型为ARIMA(1,1,1)，其表达式为：  
对原始序列$y_t$进行1阶差分得$z_t = y_t - y_{t-1}$（平稳序列），则$z_t$满足ARMA(1,1)：  
$z_t = c + \phi_1 z_{t-1} + \epsilon_t + \theta_1 \epsilon_{t-1}$  

还原为原始序列：  
$y_t - y_{t-1} = c + \phi_1 (y_{t-1} - y_{t-2}) + \epsilon_t + \theta_1 \epsilon_{t-1}$  


### 五、ARIMA的优缺点
#### 优点
- 理论成熟，可解释性强，能捕捉时间序列的线性依赖关系；
- 对短期预测效果较好，适用于无剧烈波动的序列。

#### 缺点
- 仅适用于线性关系，无法捕捉非线性趋势；
- 对长期预测效果较差，且难以处理强季节性序列（需扩展为SARIMA模型，引入季节性参数）；
- 阶数选择依赖经验，对噪声敏感。


### 六、应用场景
ARIMA适用于具有短期相关性且无突变的时间序列预测，例如：  
- 月度/季度销售额预测；
- 股票价格短期走势分析；
- 电力/燃气消费量预测等。


总之，ARIMA是时间序列分析中的经典方法，其核心是通过差分实现平稳化，再结合自回归和移动平均捕捉序列的动态规律。实际应用中需结合数据特点灵活调整参数，并通过诊断确保模型合理性。