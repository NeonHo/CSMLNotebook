时间序列数据因采集设备故障、记录遗漏等原因常出现缺失值，其填补需结合数据的**时间依赖性**（如趋势、季节性、自相关性）选择方法。以下是常见的填补方法，按复杂度从低到高分类说明：


### 一、简单填补法（忽略时间依赖性，适用于缺失率极低或数据平稳的场景）
这类方法仅利用局部或全局统计量填补，计算简单但可能丢失时间趋势信息。

#### 1. 删除法
- **原理**：直接删除包含缺失值的时间点（行删除）或整个变量（列删除）。
- **适用场景**：缺失率＜5%，且缺失为完全随机（MCAR），如偶然记录失误。
- **缺点**：破坏时间序列的连续性，丢失样本量，可能引入偏差（若缺失非随机）。


#### 2. 固定值填补
- **均值/中位数填补**：用整个序列的均值或中位数填补缺失值。  
  例：某温度序列的缺失值用所有观测值的均值$25^\circ\text{C}$填补。  
  - 优点：计算快，适用于平稳无趋势的序列（如白噪声）。  
  - 缺点：若序列有趋势（如逐年上升的销售额），会低估/高估缺失值，平滑数据波动。

- **众数填补**：适用于分类时间序列（如每天的天气类型：晴/雨/阴），用出现频率最高的类别填补。


### 二、基于时间邻近性的填补法（利用相邻数据的相关性，适用于短期缺失）
时间序列的相邻数据通常具有连续性（如股票价格、心率），可通过邻近非缺失值推断缺失值。

#### 1. 前向填充（Forward Fill, FFILL）
- **原理**：用缺失值前一个非缺失值填补，即$x_t = x_{t-1}$（$t$为缺失时刻）。  
- **适用场景**：数据变化缓慢的序列，如每小时的室内温度、稳定生产的设备参数。  
- 例：时间点$t=5$缺失，前一个值$x_4=10$，则$x_5=10$。


#### 2. 后向填充（Backward Fill, BFILL）
- **原理**：用缺失值后一个非缺失值填补，即$x_t = x_{t+1}$。  
- **适用场景**：已知后续数据的情况，如按计划记录的实验数据（如预填了采样时间，后期补测时部分缺失）。


#### 3. 线性插值（Linear Interpolation）
- **原理**：若缺失值位于$x_a$和$x_b$（$a < t < b$）之间，按时间间隔线性计算：  
  $$x_t = x_a + \frac{(t - a)}{(b - a)} \times (x_b - x_a)$$  
- **适用场景**：数据呈线性趋势的短期缺失，如某小时的用电量（上午9点到11点从100度升至140度，10点缺失则填补120度）。  


#### 4. 滑动窗口平均（Moving Window Average）
- **原理**：用缺失值前后$k$个非缺失值的均值/中位数填补，如取$t-k$到$t+k$窗口内的有效值计算。  
- 例：$k=2$时，$x_t = \frac{x_{t-2} + x_{t-1} + x_{t+1} + x_{t+2}}{4}$（假设$t-2, t-1, t+1, t+2$非缺失）。  
- **适用场景**：有短期波动但整体平稳的序列（如每日的客流量，受周末影响但局部平滑），窗口大小$k$需根据序列波动频率调整（高频波动选小$k$，低频选大$k$）。


### 三、考虑时间序列特性的填补法（结合趋势、季节性、周期性，适用于有规律的序列）
若数据存在趋势（如长期增长）、季节性（如每年春节的销售额高峰）或周期性（如每天的交通早高峰），需针对性填补。

#### 1. 季节性填补（Seasonal Imputation）
- **原理**：利用历史同期数据填补，适用于强季节性序列（如月度/季度数据）。  
  - 例：2023年3月销售额缺失，可用2020-2022年3月销售额的均值/中位数填补；若有趋势，可先用回归去除趋势，再用同期数据填补残差，最后还原。


#### 2. 差分填补（适用于非平稳序列）
- **原理**：若序列经$d$阶差分后平稳（如ARIMA模型中的处理），先对序列差分得到平稳序列$\Delta^d x_t$，填补差分序列的缺失值，再通过逆差分还原原始序列的缺失值。  
- 例：对有线性趋势的序列$x_t = a + bt + \epsilon_t$，一阶差分$\Delta x_t = x_t - x_{t-1} = b + \epsilon_t - \epsilon_{t-1}$（平稳），填补$\Delta x_t$的缺失值后，通过$x_t = x_{t-1} + \Delta x_t$还原。


### 四、模型预测填补法（利用时间序列模型或机器学习，适用于长期/复杂缺失）
通过建模捕捉数据的时间依赖关系，预测缺失值，精度更高但计算复杂。

#### 1. 时间序列模型预测
- **ARIMA/SARIMA**：利用序列的自相关性（AR项）和移动平均（MA项）建模，适用于有趋势、季节性的序列（如月度降水量）。通过对完整部分建模，预测缺失值。  
- **指数平滑法**：如Holt-Winters方法，同时考虑趋势和季节性，适合预测有规律波动的缺失值（如季度销售额）。


#### 2. 机器学习/深度学习方法
- **随机森林/梯度提升**：将时间特征（如小时、星期几）、滞后特征（$x_{t-1}, x_{t-2}$）作为输入，训练模型预测缺失值，适用于有多个影响因素的序列（如结合天气、节假日的交通流量）。  
- **LSTM/Transformer**：深度学习模型，能捕捉长程时间依赖，适用于非线性、复杂模式的序列（如股票价格、语音信号），通过学习历史序列的模式预测缺失值。


### 五、选择原则
1. **缺失率**：缺失率＜10%可优先用简单方法（如插值、FFILL）；缺失率高（＞30%）需用模型预测。  
2. **时间特性**：  
   - 平稳无趋势：滑动窗口平均、均值填补；  
   - 有趋势/季节性：差分填补、季节性填补、ARIMA；  
   - 非线性复杂模式：LSTM、梯度提升。  
3. **计算成本**：实时场景（如传感器数据）优先用FFILL/线性插值；离线分析可用复杂模型提升精度。


### 总结
时间序列缺失值填补的核心是**保留数据的时间依赖性**：简单方法适合快速处理或数据平稳的场景，而基于时间相关性的方法和模型预测法则更适合有趋势、季节性或复杂模式的序列，需根据数据特点平衡精度与效率。