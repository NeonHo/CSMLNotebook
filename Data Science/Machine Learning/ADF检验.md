### 详解ADF检验（Augmented Dickey-Fuller Test）

ADF检验是时间序列分析中用于检验序列**平稳性**的核心方法，其全称为“扩展迪基-富勒检验”（Augmented Dickey-Fuller Test），是对基础的DF检验（Dickey-Fuller Test）的扩展，用于解决序列中可能存在的自相关问题。
[[时间序列预测基本概念#**6. 平稳性（Stationarity）**]]

#### 一、平稳性与单位根：ADF检验的核心背景
##### 1. 平稳性的定义
时间序列的平稳性是指序列的统计特性（如均值、方差、自协方差）不随时间推移而变化。具体分为：
- **严平稳**：所有统计特性均不随时间变化；
- **弱平稳（宽平稳）**：均值为常数，方差为常数，自协方差仅与时间间隔（滞后阶数）有关，与具体时间点无关。

多数时序模型（如ARMA、[[ARIMA]]）要求序列满足弱平稳性，否则模型参数估计会出现偏差（如“伪回归”）。

##### 2. 单位根与非平稳性
[[时间序列预测基本概念#**12. 单位根（Unit Root）**]]
[[时间序列预测基本概念#**11. 白噪声（White Noise）**]]
非平稳序列的常见成因是存在“单位根”（Unit Root）。若序列$x_t$满足以下随机游走模型：
$$
x_t = x_{t-1} + \varepsilon_t
$$
其中$\varepsilon_t$是白噪声（均值为0，方差恒定的随机扰动），则该序列存在单位根，且是非平稳的——其方差会随时间累积增大（$Var(x_t) = t \cdot Var(\varepsilon_t)$）。

ADF检验的核心目标是**判断序列是否存在单位根**：若存在单位根，则序列非平稳；反之则平稳。


#### 二、DF检验：ADF的基础
ADF检验由DF检验扩展而来，先理解DF检验的原理：

DF检验针对以下三种模型（均假设误差项$\varepsilon_t$无自相关）：
1. **无常数项，无趋势项**：
   $$
   \Delta x_t = \gamma x_{t-1} + \varepsilon_t
   $$
2. **含常数项（截距），无趋势项**：
   $$
   \Delta x_t = \alpha + \gamma x_{t-1} + \varepsilon_t
   $$
3. **含常数项和趋势项**：
   $$
   \Delta x_t = \alpha + \beta t + \gamma x_{t-1} + \varepsilon_t
   $$
其中，$\Delta x_t = x_t - x_{t-1}$为一阶差分，$\alpha$为常数项，$\beta t$为时间趋势项，$\gamma$为待估参数。

**检验逻辑**：  
原假设$H_0: \gamma = 0$（存在单位根，序列非平稳）；  
备择假设$H_1: \gamma < 0$（不存在单位根，序列平稳）。  

通过估计模型得到$\gamma$的t统计量，与DF检验的临界值比较：若t统计量小于临界值，则拒绝$H_0$，认为序列平稳。


#### 三、ADF检验：解决自相关问题
DF检验的局限性在于**假设误差项$\varepsilon_t$无自相关**，但实际时序数据中误差项常存在自相关（即$\varepsilon_t$与$\varepsilon_{t-1}, \varepsilon_{t-2}, ...$相关）。ADF检验通过引入**滞后差分项**消除自相关，扩展了DF检验的适用范围。

##### 1. ADF检验的模型形式
ADF检验的三种模型在DF检验基础上加入$p$阶滞后差分项$\Delta x_{t-1}, \Delta x_{t-2}, ..., \Delta x_{t-p}$，具体如下：

- **模型1（无常数项，无趋势项）**：
  $$
  \Delta x_t = \gamma x_{t-1} + \sum_{i=1}^p \phi_i \Delta x_{t-i} + \varepsilon_t
  $$

- **模型2（含常数项，无趋势项）**：
  $$
  \Delta x_t = \alpha + \gamma x_{t-1} + \sum_{i=1}^p \phi_i \Delta x_{t-i} + \varepsilon_t
  $$

- **模型3（含常数项和趋势项）**：
  $$
  \Delta x_t = \alpha + \beta t + \gamma x_{t-1} + \sum_{i=1}^p \phi_i \Delta x_{t-i} + \varepsilon_t
  $$

其中，$p$为滞后阶数（需通过准则确定），$\phi_i$为滞后项系数，$\varepsilon_t$为白噪声（无自相关）。

##### 2. 核心假设与检验逻辑
- **原假设$H_0$**：$\gamma = 0$（序列存在单位根，非平稳）；  
- **备择假设$H_1$**：$\gamma < 0$（序列不存在单位根，平稳）。  

检验逻辑与DF一致：计算$\gamma$的t统计量（称为ADF统计量），若其值小于临界值（或p值小于显著性水平，如0.05），则拒绝$H_0$，认为序列平稳。


#### 四、ADF检验的关键步骤
1. **选择模型形式**：根据序列是否有常数均值或趋势，选择上述三种模型之一（实际应用中常通过可视化序列趋势判断，或同时检验三种模型）。  
2. **确定滞后阶数$p$**：目的是消除残差自相关，常用准则：  
   - AIC（赤池信息准则）：$AIC = -2\ln(L) + 2k$（$L$为似然值，$k$为参数个数），选择AIC最小的$p$；  
   - BIC（贝叶斯信息准则）：$BIC = -2\ln(L) + k\ln(n)$（$n$为样本量），逻辑类似。  
1. **估计模型与计算ADF统计量**：通过OLS估计模型参数，得到$\gamma$的t统计量。  
2. **对比临界值或p值**：  
   - ADF临界值比普通t检验更负（需查表或通过软件计算，与样本量相关）；  
   - 若$ADF统计量 < 临界值$（或$p值 < 0.05$），则拒绝$H_0$，序列平稳；反之则接受$H_0$，序列非平稳。  


#### 五、ADF检验的应用场景
1. **ARIMA建模前置检验**：ARIMA模型要求序列平稳，ADF检验用于判断序列是否需要差分（如非平稳则进行d阶差分，直至平稳）。  
2. **伪回归诊断**：非平稳序列回归可能导致“伪回归”（高$R^2$但无实际意义），ADF检验可提前筛选平稳序列。  
3. **趋势分析**：通过含趋势项的模型，判断序列是否存在确定性趋势（若$\beta \neq 0$且显著）。  


#### 六、注意事项
1. **临界值的特殊性**：ADF统计量的分布是非标准的，临界值需根据模型形式（是否含常数/趋势）和样本量查询专用表格（软件如Python的statsmodels会自动计算）。  
2. **过度差分风险**：若序列已平稳，仍强行差分会导致序列过度平稳（引入负自相关），影响后续建模效果。  
3. **小样本偏差**：样本量较小时（如$n < 50$），ADF检验的功效较低（易误判），需结合其他方法（如PP检验）交叉验证。  


#### 七、总结
ADF检验是检验时序平稳性的权威方法，通过扩展DF检验解决了残差自相关问题，其核心是判断序列是否存在单位根。在实际应用中，需合理选择模型形式、滞后阶数，并结合p值或临界值做出结论，为后续时序建模（如ARIMA）提供关键依据。