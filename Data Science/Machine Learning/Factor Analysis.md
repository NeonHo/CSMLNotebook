因子分析（Factor Analysis）是一种**降维和数据简化技术**，核心思想是通过少数几个不可直接观测的“潜在因子”（Latent Factors）来解释多个可观测变量之间的相关性，从而揭示数据的内在结构。例如，“学习能力”这一潜在因子可以解释“数学成绩”“阅读速度”“记忆测试得分”等多个观测变量的相关性。


#### 一、核心原理与数学表达
因子分析假设：每个观测变量的取值由两部分构成——**公共因子**（影响多个变量的潜在因素）和**特殊因子**（仅影响单个变量的独特因素，含误差）。

##### 1. 基本模型
对于$p$个观测变量$X_1, X_2, ..., X_p$和$m$个公共因子$F_1, F_2, ..., F_m$（$m < p$），变量与因子的关系可表示为：

$$
\begin{cases}
X_1 = a_{11}F_1 + a_{12}F_2 + ... + a_{1m}F_m + \epsilon_1 \\
X_2 = a_{21}F_1 + a_{22}F_2 + ... + a_{2m}F_m + \epsilon_2 \\
\vdots \\
X_p = a_{p1}F_1 + a_{p2}F_2 + ... + a_{pm}F_m + \epsilon_p \\
\end{cases}
$$

用矩阵形式简写为：  
$$X = AF + \epsilon$$  

其中：  
- $X = (X_1, X_2, ..., X_p)^T$为观测变量向量（已标准化，即均值为0，方差为1）；  
- $F = (F_1, F_2, ..., F_m)^T$为公共因子向量（潜在变量，均值为0，方差为1）；  
- $A = (a_{ij})_{p \times m}$为**因子载荷矩阵**，$a_{ij}$称为“因子载荷”（Factor Loadings）；  
- $\epsilon = (\epsilon_1, \epsilon_2, ..., \epsilon_p)^T$为特殊因子向量（仅影响单个变量，含误差）。  


##### 2. 关键概念
- **因子载荷（$a_{ij}$）**：表示第$i$个变量与第$j$个公共因子的**相关程度**（绝对值越大，相关性越强）。例如，若“数学成绩”在“逻辑因子”上的载荷为0.8，则说明两者高度相关。  
- **变量共同度（Communality）**：第$i$个变量的方差中被所有公共因子解释的比例，记为$h_i^2 = \sum_{j=1}^m a_{ij}^2$。$h_i^2$越接近1，说明该变量的大部分信息被公共因子捕获。  
- **因子方差（Factor Variance）**：第$j$个公共因子对所有变量的总解释力，记为$S_j^2 = \sum_{i=1}^p a_{ij}^2$（也称“因子特征值”），值越大，因子越重要。  


#### 二、基本假设
因子分析的有效性依赖于以下假设：  
1. 公共因子$F_1, ..., F_m$之间不相关（或允许相关，对应“探索性因子分析”和“验证性因子分析”）；  
2. 特殊因子$\epsilon_1, ..., \epsilon_p$之间不相关，且与公共因子不相关；  
3. 所有变量和公共因子均已标准化（均值为0，方差为1）；  
4. 特殊因子的方差较小（即变量的大部分变异由公共因子解释）。  


#### 三、因子分析的核心步骤
##### 1. 数据预处理
- 对变量标准化（消除量纲影响）；  
- 检验适用性：通过**KMO检验**和**Bartlett球形检验**判断数据是否适合因子分析：  
  - KMO值（0~1）：越接近1，变量间相关性越强，越适合因子分析（通常要求>0.5）；  
  - Bartlett球形检验：原假设为“变量独立”，若$p<0.05$，则拒绝原假设，适合因子分析。  


##### 2. 提取公共因子
目标是确定因子数量$m$和初始因子载荷矩阵$A$，常用方法包括：  
- **主成分分析法（PCA）**：最常用，先计算变量的主成分，取前$m$个主成分作为初始公共因子，再调整载荷矩阵使模型更符合因子分析假设。  
- **最大似然估计法**：假设数据服从多元正态分布，通过最大化似然函数估计因子载荷，结果更稳健但计算复杂。  
- **主轴因子法**：基于变量的相关矩阵，用共同度估计值替代对角线元素（方差），迭代优化载荷矩阵。  


##### 3. 确定因子数量$m$
- **Kaiser准则**：保留特征值$S_j^2 > 1$的因子（特征值>1表示因子解释力超过单个变量）；  
- **碎石图（Scree Plot）**：绘制特征值随因子序号的变化曲线，找“拐点”（特征值开始平缓下降的点），拐点前的因子保留；  
- **累计方差解释率**：保留累计解释方差比例达到70%~80%的因子（根据实际需求调整）。  


##### 4. 因子旋转
初始因子载荷矩阵可能难以解释（变量在多个因子上均有中等载荷），**旋转**的目的是使载荷矩阵“简单化”：让每个变量仅在少数几个因子上有高载荷（即“简单结构”）。  

- **正交旋转**：因子间保持不相关（最常用的是**方差最大旋转（Varimax）**，使每个因子上载荷的方差最大化，增强解释性）；  
- **斜交旋转**：允许因子间相关（如Promax旋转），适用于因子本身可能相关的场景（如“语言能力”和“逻辑能力”可能相关）。  


##### 5. 因子得分
估计每个样本在公共因子上的取值（因子得分），用于后续分析（如聚类、回归、可视化）。常用方法：  
- **回归法**：以因子为因变量，变量为自变量，通过最小二乘估计得分；  
- **Bartlett法**：考虑因子方差的加权估计，得分更准确但计算复杂。  


#### 四、应用场景
- **心理学**：通过多个量表题（如“焦虑测试”的10个问题）提取“焦虑水平”等潜在因子；  
- **市场调研**：分析消费者对产品的评分（如“价格”“外观”“性能”），提取“性价比因子”“体验因子”等；  
- **社会学**：用“收入”“教育水平”“职业”等变量提取“社会经济地位”因子；  
- **生物学**：通过基因表达数据提取“代谢因子”“免疫因子”等潜在生物过程。  


#### 五、与主成分分析（PCA）的区别
| 维度                | 因子分析（FA）                          | 主成分分析（PCA）                      |
|---------------------|-----------------------------------------|---------------------------------------|
| 核心目标            | 解释变量间的相关性（找潜在因果因子）    | 降维，用少数主成分概括变量的总变异    |
| 模型假设            | 变量 = 公共因子 + 特殊因子（因果关系）  | 主成分 = 变量的线性组合（无因果假设）  |
| 关注点              | 变量间的共享变异（排除特殊因子）        | 变量的总变异（包括所有信息）          |
| 因子/主成分的意义   | 潜在、可解释的因子（如“智力”）          | 综合变量（如“第一主成分”）            |


#### 六、优缺点
- **优点**：揭示数据内在结构，因子可解释性强，能处理变量间的相关性；  
- **缺点**：结果受因子数量、旋转方法影响较大；假设较多（如因子独立性），对非正态数据可能不稳健；需要较大样本量（通常样本量是变量数的5~10倍以上）。  


综上，因子分析是一种通过“潜在因子”简化复杂数据的强大工具，核心在于平衡降维效果与因子的可解释性，广泛应用于社会科学、商业分析等领域。